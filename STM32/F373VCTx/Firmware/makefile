
# Author    KMS - Martin Dubois, P. Eng.
# Copyright (C) 2022 KMS
# License   http://www.apache.org/licenses/LICENSE-2.0
# Product   KMS-Framework
# File      STM32/F373CVTx/Firmware/makefile

EMBEDDED = STM32F373VCTx

include ../../$(CONFIG).mk

include $(KMS_MAKEFILES)/stm32f373cvtx.mk

LIBRARIES = $(SPI_SIM_B_A) $(KMS_STM32_A) $(KMS_A_A)

OUTPUT = ../Binaries/$(CONFIG)/Firmware.elf

SOURCES = Firmware.cpp

# ===== Macros ==============================================================

OBJECTS = $(SOURCES:.cpp=.o)

# ===== Rules ===============================================================

.cpp.o:
	$(GPP) -c $(CFLAGS) -o $@ $(INCLUDES) $<

# ===== Targets =============================================================

$(OUTPUT): Startup.o $(OBJECTS) $(LIBRARIES)
	$(GPP) $(CFLAGS) -T"$(KMS_LINKER_SCRIPTS)/STM32F373VCTX_FLASH.ld" -Wl,-Map="Firmware.map" -o $@ $^
	$(SIZE) $@

# ===== Specific rules ======================================================

Startup.o: $(KMS_STARTUP)/startup_stm32F373vctx.s
	$(AS) -c $(CFLAGS) -o $@ $<

# DO NOT DELETE - Generated by KMS::Build::Make !

Firmware.o: ../../../Common/Protocol.h ../../../Common/Simulator.h

